<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ajax</title>
  </head>
  <body>
    <h1>Exemplo simples com Ajax</h1>
    <p>
      Lorem ipsum dolor sit, amet consectetur adipisicing elit. Est sit sequi
      praesentium itaque incidunt eum, assumenda, nam repudiandae autem laborum,
      dignissimos nulla maiores optio. Nemo possimus debitis magni explicabo ut!
    </p>

    <h3>Qual será o texto que vem em seguida?</h3>
    <p id="texto"></p>
    <button id="botao">Apresentar o Texto</button>

    <script>
      document.querySelector("#botao").addEventListener("click", () => {
        // vamos usar um objeto do tipo XMLHttpRequest
        let request = new XMLHttpRequest();

        // Preparar o pedido
        // [metodo, url, async]
        request.open(
          "GET",
          "http://localhost/ajax_javascript_php/02_exemplo/texto.txt",
          true
        );

        // prepara uma função de callback
        request.onreadystatechange = function () {
          console.log(request.readyState, request.status);

          // verificar se a proposta está pronta
          if (request.readyState === 4) {
            if (request.status === 200) {
              console.log("success");
              console.log(request.response);
              document.querySelector("#texto").textContent = this.response;
            } else {
              console.log("error");
              console.log(request.response);
            }
          }
        };

        // efetuar o pedido
        request.send();
      });
    </script>
  </body>
</html>
